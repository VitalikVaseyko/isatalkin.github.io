var Main=Main||{};$(function(){!!navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)&&$("body").addClass("_mac"),svg4everybody();$(".js-modal-trigger");Main.openPopup=function(o){var e=$(".js-modal");if($("#"+o).length)return $.each(e,function(){$(this).attr("id")===o&&($(this).addClass("opened"),$("body").addClass("overflow"))}),!1},Main.closePopup=function(o){var e=$(".js-modal");$.each(e,function(){$(this).attr("id")===o&&($(this).removeClass("opened"),$("body").removeClass("overflow"))}),$("#player").length&&(console.log($("#player").get(0)),$("iframe").attr("src",$("iframe").attr("src")))},$(document).on("click",".js-modal-trigger",function(o){var e=$(this).attr("data-target");o.preventDefault(),Main.openPopup(e)}),$(".js-close").on("click",function(){var o=$(this).data("target");Main.closePopup(o)}),$(document).mouseup(function(o){var e=$(".popup--compact");$(".popup--compact").hasClass("opened")&&(0!==e.has(o.target).length||$(".js-modal.opened").is("._check-required")||($(".js-modal.popup--compact").removeClass("opened"),$("body").removeClass("overflow")))}),$(this).keydown(function(o){27!=o.which||$(".js-modal.opened").is("._check-required")||($("body").removeClass("overflow"),$(".js-modal").removeClass("opened"))}),function(){var o,e,t=[];for($(".js-modal").each(function(){var o=$(this).attr("id");t.push(o)}),e=0;e<t.length;e++)"#"+t[e]==window.location.hash&&$("#"+t[e]).length&&(o=t[e],Main.openPopup(o))}();var o,e,t=$(window),n=$(".js-nav-trigger"),s=$(".js-header"),i=$(".js-subnav-trigger"),a=$(".navigation-list__item");(n.on("click",function(){s.hasClass("opened")?(s.removeClass("opened"),$("body").removeClass("overflow")):(s.addClass("opened"),$("body").addClass("overflow"))}),i.on("click",function(o){0===i.has(o.target).length&&($(this).siblings().removeClass("expanded"),$(this).toggleClass("expanded"))}),t.on("scroll",function(){(o=!($(this).scrollTop()>50))!==e&&(o?s.removeClass("scrolling"):s.addClass("scrolling")),e=o}),$(".js-accordeon-toggler").length)&&$(".js-accordeon-toggler").on("click",function(){$(this).closest(".accordeon-link").siblings().removeClass("expanded"),$(this).closest(".accordeon-link").toggleClass("expanded")});t.width()>768&&a.hover(),$(".js-press").length&&$(".js-press").on("click",function(){$(this).closest(".for-press").toggleClass("expanded")}),$(".js-clear").length&&$(".js-clear").on("click",function(){$(this).closest("form")[0].reset()}),$("video[autoplay]").lebgth&&$("video[autoplay]").each(function(){this.play()});var r=function(){if($(".promo-slider").length&&t.width()>1024){for(var o=$(".promo-slider").find(".promo-tile__text"),e=[],n=0;n<o.length;n++)e.push(o[n].offsetHeight);var s=Math.max.apply(null,e);o.css("min-height",s)}};r(),t.on("resize",function(){r()});new XMLHttpRequest;var l=document.cookie.match(/csrftoken=([\w-]+)/);if(l)var c=l[1];if($(".js-search-field").on("input",function(){$(this).val()?$(".js-clear").addClass("show"):$(".js-clear").removeClass("show")}),$(".js-clear").on("click",function(){$(this).removeClass("show")}),$(".form__tooltip").hide(),$(".form__submit").on("click",function(o){o.preventDefault();var e=$("#theme .select-form__option:selected").val(),t=$("input#name"),n=t.val(),s=$("input#email"),i=s.val(),a=$("textarea#comment"),r=a.val(),l=$("#accept");if(form=$("form.form"),url=form.attr("action"),(d=$(".form__tooltip")).hide(),""==n){var d=t.parent().find(d).show();return t.focus(),!1}if(""==i){d=s.parent().find($(".form__tooltip--empty")).show();return s.focus(),!1}if(1!==(i.match(/.+?\@.+/g)||[]).length){d=$(".form__tooltip--email").show();return s.focus(),!1}if(""==r){d=a.parent().find(d).show();return a.focus(),!1}if(0==l.prop("checked")){d=l.parent().find(d).show();return!1}return $.ajax({beforeSend:function(o){o.setRequestHeader("X-CSRFToken",c)},url:url,type:"POST",data:JSON.stringify({topic:e,name:n,email:i,comment:r}),cache:!1,contentType:"application/json",processData:!1,success:$(document).ajaxSuccess(function(){$(form).fadeOut("slow"),$(form).prev().text("Ваша заявка успешно отправлена"),setTimeout(function(){$(".popup__btn-close").click()},1e3)}),error:$(document).ajaxError(function(){$(form).prev().text("Что-то пошло не так, сообщение не отправлено")})}),!1}),$(".history-block__pointer").length&&($(window).on("scroll",function(){0!==$(window).scrollTop()?$(".history-block__pointer--up").removeClass("hidden"):$(".history-block__pointer--up").addClass("hidden"),$(window).scrollTop()+$(window).height()===$(document).height()?$(".history-block__pointer--down").addClass("hidden"):$(".history-block__pointer--down").removeClass("hidden")}),$(".history-block__pointer--up").on("click",function(){$("html,body").animate({scrollTop:window.pageYOffset-$(window).height()},200)}),$(".history-block__pointer--down").on("click",function(){$("html,body").animate({scrollTop:window.pageYOffset+$(window).height()},200)})),$(".about__content").length){var d=$(".about__content").find("p").find("a");d.length&&d.each(function(){$(this).on("click",function(o){"pdf"===this.href.split("").slice(-3).join("")&&(o.preventDefault(),o.stopPropagation(),window.open(this.href,"_blank"))})})}});